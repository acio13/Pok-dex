<!-- Pok√©dx Mobile App -->

<div class="pokedex-container" *ngIf="!isDetailRoute()">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <svg viewBox="0 0 24 24" class="pokedex-icon">
          <rect x="4" y="6" width="16" height="12" rx="2" fill="#dc0a2d" stroke="#a00"/>
          <rect x="6" y="8" width="12" height="6" fill="#333" rx="1"/>
          <rect x="7" y="9" width="10" height="4" fill="#0f4" rx="0.5"/>
          <circle cx="20" cy="7" r="1.5" fill="#44f"/>
          <circle cx="17" cy="7" r="1" fill="#ff4"/>
          <rect x="6" y="15" width="2" height="1" fill="#666" rx="0.5"/>
          <rect x="9" y="15" width="2" height="1" fill="#666" rx="0.5"/>
          <rect x="12" y="15" width="2" height="1" fill="#666" rx="0.5"/>
        </svg>
        <h1>Pok√©dx</h1>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Pokemon Section -->
    <section class="welcome-section">
      <!-- Loading Spinner -->
      <div class="loading-container" *ngIf="loading">
        <div class="pokeball-spinner"></div>
        <p>Loading Pok√©mon...</p>
      </div>

      <!-- Pokemon Cards Grid -->
      <div class="pokemon-grid" *ngIf="!loading && pokemonList.length > 0">
        <h2 *ngIf="!isSearching">Pok√©mon Collection</h2>
        <h2 *ngIf="isSearching">Search Results</h2>
        <div class="pokemon-cards-container">
          <div 
            class="pokemon-card" 
            *ngFor="let pokemon of pokemonList" 
            [style.background]="'linear-gradient(135deg, ' + getTypeColor(pokemon.types[0]) + ', ' + getTypeColor(pokemon.types[1] || pokemon.types[0]) + ')'"
            (mousedown)="saveHomePageState()"
            (touchstart)="saveHomePageState()"
            (click)="navigateToPokemonDetail(pokemon.id)"
          >
            <div class="pokemon-number">#{{ pokemon.id.toString().padStart(4, '0') }}</div>
            <div class="pokemon-image-container">
              <img 
                [src]="pokemon.imageUrl" 
                [alt]="pokemon.name"
                class="pokemon-image"
                (error)="onImageError($event)"
              >
            </div>
            <div class="pokemon-info">
              <h3 class="pokemon-name">{{ pokemon.name }}</h3>
              <div class="pokemon-types">
                <span 
                  class="type-badge" 
                  *ngFor="let type of pokemon.types"
                  [style.background-color]="getTypeColor(type)"
                >
                  {{ type }}
                </span>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Load More Button - Show when there are more results available -->
        <div class="load-more-container" *ngIf="!isSearching && hasMoreResults()">
          <button 
            type="button"
            class="load-more-btn" 
            (click)="loadMore(); $event.preventDefault()" 
            [disabled]="loadingMore"
          >
            <span *ngIf="!loadingMore">Load More Pok√©mon</span>
            <span *ngIf="loadingMore">Loading...</span>
          </button>
        </div>
      </div>

      <!-- Welcome Message when no Pokemon -->
      <div class="welcome-card" *ngIf="!loading && pokemonList.length === 0 && !isInSearchMode">
        <h2>Welcome to your Pok√©dx!</h2>
        <p>Explore the world of Pok√©mon with this mobile app optimized for Android and iOS.</p>
        
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">üì±</div>
            <h3>Mobile-First</h3>
            <p>Optimized for mobile devices</p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üîç</div>
            <h3>Advanced Search</h3>
            <p>Find your favorite Pok√©mon</p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">üíæ</div>
            <h3>Offline Ready</h3>
            <p>Works without internet connection</p>
          </div>
          
          <div class="feature-card">
            <div class="feature-icon">‚ö°</div>
            <h3>Performance</h3>
            <p>Fast and responsive</p>
          </div>
        </div>
      </div>

      <!-- No Search Results Message -->
      <div class="no-results" *ngIf="!loading && pokemonList.length === 0 && isInSearchMode && searchQuery.trim()">
        <div class="no-results-content">
          <svg viewBox="0 0 24 24" class="no-results-icon">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          <h3>No Pok√©mon Found</h3>
          <p>No Pok√©mon found matching "{{ searchQuery }}".</p>
          <p>Try adjusting your search filters.</p>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom Navigation (Mobile) -->
  <nav class="bottom-nav">
    <a class="nav-item" [class.active]="router.url === '/'" (click)="router.navigate(['/'])" style="cursor: pointer;">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
      </svg>
      <span>Home</span>
    </a>
    
    <a class="nav-item" [class.active]="router.url === '/search'" (click)="navigateToSearch()" style="cursor: pointer;">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <span>Search</span>
    </a>
    
    <a href="#" class="nav-item">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
      </svg>
      <span>Favorites</span>
    </a>
  </nav>
</div>

<!-- Floating Search Button -->
<button 
  class="floating-search-btn"
  (click)="toggleFloatingSearch()"
  *ngIf="!isDetailRoute()"
  title="Search Pok√©mon"
>
  <svg viewBox="0 0 24 24" class="search-icon">
    <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
  </svg>
</button>

<!-- Floating Search Modal -->
<div 
  class="floating-search-modal" 
  *ngIf="showFloatingSearch"
  (click)="closeFloatingSearch($event)"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="closeFloatingSearch()">‚úï</button>
    <div class="search-input-container">
      <svg viewBox="0 0 24 24" class="search-icon-input">
        <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <input 
        #floatingSearchInput
        type="text" 
        placeholder="Search for a Pok√©mon" 
        class="search-input"
        [(ngModel)]="floatingSearchQuery"
        (keydown.enter)="performFloatingSearch()"
      />
    </div>
    <button 
      class="search-button" 
      (click)="performFloatingSearch()"
      [disabled]="!floatingSearchQuery.trim()"
    >
      Cerca
    </button>
  </div>
</div>

<!-- Router Outlet for different pages -->
<router-outlet></router-outlet>
