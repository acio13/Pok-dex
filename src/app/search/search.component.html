<div class="search-container">
  <!-- Header -->
  <header class="header">
    <div class="logo">
      <svg viewBox="0 0 24 24" class="pokedex-icon">
        <rect x="4" y="6" width="16" height="12" rx="2" fill="#dc0a2d" stroke="#a00"/>
        <rect x="6" y="8" width="12" height="6" fill="#333" rx="1"/>
        <rect x="7" y="9" width="10" height="4" fill="#0f4" rx="0.5"/>
        <circle cx="20" cy="7" r="1.5" fill="#44f"/>
        <circle cx="17" cy="7" r="1" fill="#ff4"/>
        <rect x="6" y="15" width="2" height="1" fill="#666" rx="0.5"/>
        <rect x="9" y="15" width="2" height="1" fill="#666" rx="0.5"/>
        <rect x="12" y="15" width="2" height="1" fill="#666" rx="0.5"/>
      </svg>
      <h1>Pokédx</h1>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Search Controls -->
    <div class="search-controls">
    <!-- Filter Form Toggle Button -->
    <button type="button" class="toggle-filters-btn" (click)="toggleFilterForm()">
      <svg viewBox="0 0 24 24" class="filter-icon">
        <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
      </svg>
      {{ isFilterFormOpen ? 'Hide Filters' : 'Show Filters' }}
      <svg viewBox="0 0 24 24" class="chevron-icon" [class.rotated]="isFilterFormOpen">
        <path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"/>
      </svg>
    </button>

    <!-- Combined Search Form -->
    <form class="search-form" [class.collapsed]="!isFilterFormOpen" (ngSubmit)="onSearch()">
      
      <!-- Name Filter -->
      <div class="filter-group">
        <label for="nameFilter" class="filter-label">Name</label>
        <input 
          id="nameFilter"
          type="text" 
          placeholder="Enter Pokémon name..."
          class="filter-input"
          [(ngModel)]="nameFilter"
          name="nameFilter"
        />
      </div>

      <!-- Number Filter -->
      <div class="filter-group">
        <label for="numberFilter" class="filter-label">Pokédex Number</label>
        <input 
          id="numberFilter"
          type="number" 
          placeholder="Enter Pokédex number..."
          class="filter-input"
          [(ngModel)]="numberFilter"
          name="numberFilter"
          min="1"
          max="10000"
        />
      </div>

      <!-- Type Filter -->
      <div class="filter-group">
        <label for="typeFilter" class="filter-label">Type</label>
        <select 
          id="typeFilter"
          class="filter-select"
          [(ngModel)]="typeFilter"
          name="typeFilter"
        >
          <option value="">Select a type...</option>
          <option *ngFor="let type of pokemonTypes" [value]="type">
            {{ type | titlecase }}
          </option>
        </select>
      </div>

      <!-- Generation Filter -->
      <div class="filter-group">
        <label for="generationFilter" class="filter-label">Generation</label>
        <select 
          id="generationFilter"
          class="filter-select"
          [(ngModel)]="generationFilter"
          name="generationFilter"
        >
          <option value="">Select a generation...</option>
          <option *ngFor="let generation of pokemonGenerations" [value]="generation.value">
            {{ generation.name }} (#{{ generation.minId }}-{{ generation.maxId }})
          </option>
        </select>
      </div>

      <!-- Search and Clear Buttons -->
      <div class="button-group">
        <button 
          type="submit" 
          class="search-btn"
          [disabled]="!nameFilter.trim() && !numberFilter.toString().trim() && !typeFilter.trim() && !generationFilter.trim()"
        >
          <svg viewBox="0 0 24 24" class="search-icon">
            <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          Search
        </button>
        
        <button 
          type="button"
          class="clear-btn" 
          (click)="clearSearch()"
          *ngIf="nameFilter.trim() || numberFilter.toString().trim() || typeFilter.trim() || generationFilter.trim()"
        >
          <svg viewBox="0 0 24 24" class="clear-icon">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
          Clear
        </button>
      </div>
      
    </form>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading-container">
    <div class="pokeball-spinner"></div>
    <p>Searching...</p>
  </div>

  <!-- Search Results -->
  <div *ngIf="!isLoading && hasSearched" class="results-container">
    <!-- Results Header -->
    <div class="results-header" *ngIf="searchResults.length > 0">
      <h2>Search Results</h2>
      <p>Found {{ searchResults.length }} Pokémon</p>
      
      <!-- Pagination Info -->
      <div class="pagination-info" *ngIf="searchResults.length > itemsPerPage">
        Page {{ currentPage }} of {{ getTotalPages() }}
        ({{ (currentPage - 1) * itemsPerPage + 1 }}-{{ Math.min(currentPage * itemsPerPage, searchResults.length) }} of {{ searchResults.length }})
      </div>
    </div>

    <!-- Pokemon Grid -->
    <div class="pokemon-grid" *ngIf="searchResults.length > 0">
      <div class="pokemon-cards-container">
        <div 
          class="pokemon-card"
          *ngFor="let pokemon of getPaginatedResults()"
          [style.background]="getCardBackground(pokemon)"
          (click)="navigateToPokemon(pokemon.id)"
        >
          <div class="pokemon-number">#{{ pokemon.id.toString().padStart(4, '0') }}</div>
          
          <div class="pokemon-image-container">
            <img 
              [src]="pokemon.sprites.other?.['official-artwork']?.front_default || pokemon.sprites.front_default || 'https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/' + pokemon.id + '.png'"
              [alt]="pokemon.name"
              class="pokemon-image"
              loading="lazy"
            />
          </div>
          
          <div class="pokemon-info">
            <h3 class="pokemon-name">{{ pokemon.name }}</h3>
            <div class="pokemon-types">
              <span 
                *ngFor="let type of pokemon.types" 
                class="type-badge"
                [style.background-color]="getTypeColor(type.type.name)"
              >
                {{ type.type.name }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Pagination Controls -->
    <div class="pagination-controls" *ngIf="searchResults.length > itemsPerPage">
      <button 
        class="page-btn"
        [disabled]="!canGoPrevious()"
        (click)="previousPage()"
      >
        <svg viewBox="0 0 24 24" class="page-icon">
          <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
        Previous
      </button>
      
      <span class="page-indicator">
        {{ currentPage }} / {{ getTotalPages() }}
      </span>
      
      <button 
        class="page-btn"
        [disabled]="!canGoNext()"
        (click)="nextPage()"
      >
        Next
        <svg viewBox="0 0 24 24" class="page-icon">
          <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
      </button>
    </div>

    <!-- No Results -->
    <div *ngIf="searchResults.length === 0" class="no-results">
      <div class="no-results-content">
        <svg viewBox="0 0 24 24" class="no-results-icon">
          <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
        <h3>No Pokémon Found</h3>
        <p *ngIf="nameFilter && numberFilter && typeFilter">
          No Pokémon found matching all filters: Name "{{ nameFilter }}", Number "{{ numberFilter }}", Type "{{ typeFilter | titlecase }}".
        </p>
        <p *ngIf="nameFilter && numberFilter && !typeFilter">
          No Pokémon found with name "{{ nameFilter }}" and number "{{ numberFilter }}".
        </p>
        <p *ngIf="nameFilter && !numberFilter && typeFilter">
          No Pokémon found with name "{{ nameFilter }}" and type "{{ typeFilter | titlecase }}".
        </p>
        <p *ngIf="!nameFilter && numberFilter && typeFilter">
          No Pokémon found with number "{{ numberFilter }}" and type "{{ typeFilter | titlecase }}".
        </p>
        <p *ngIf="nameFilter && !numberFilter && !typeFilter">
          No Pokémon found with name "{{ nameFilter }}".
        </p>
        <p *ngIf="!nameFilter && numberFilter && !typeFilter">
          No Pokémon found with number "{{ numberFilter }}".
        </p>
        <p *ngIf="!nameFilter && !numberFilter && typeFilter">
          No Pokémon found with type "{{ typeFilter | titlecase }}".
        </p>
        <p>Try adjusting your search filters.</p>
      </div>
    </div>
  </div>
  </main>

  <!-- Bottom Navigation (Mobile) -->
  <nav class="bottom-nav">
    <a class="nav-item" [class.active]="isHomeActive" (click)="router.navigate(['/'])" style="cursor: pointer;">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
      </svg>
      <span>Home</span>
    </a>
    
    <a class="nav-item" [class.active]="isSearchActive" (click)="navigateToSearch()" style="cursor: pointer;">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      <span>Search</span>
    </a>
    
    <a href="#" class="nav-item">
      <svg viewBox="0 0 24 24" class="nav-icon">
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
        <rect x="4" y="4" width="16" height="3" fill="currentColor" opacity="0.7"/>
      </svg>
      <span>TCG</span>
    </a>
  </nav>

</div>